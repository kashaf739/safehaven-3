{% extends 'base.html' %}

{% block content %}
<div class="form-container">
    <h1>Edit Patient Information</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <form method="POST" action="{{ url_for('edit_patient', patient_id=patient.patient_id) }}">
        <div class="form-group">
            <label>Patient ID:</label>
            <input type="text" value="{{ patient.patient_id }}" disabled class="form-control">
        </div>

        <div class="form-group">
            <label for="name">Name:</label>
            <input type="text" name="name" id="name" value="{{ patient.name }}" required class="form-control">
        </div>

        <div class="form-group">
            <label for="gender">Gender:</label>
            <select name="gender" id="gender" required class="form-control">
                <option value="Male" {% if patient.gender == 'Male' %}selected{% endif %}>Male</option>
                <option value="Female" {% if patient.gender == 'Female' %}selected{% endif %}>Female</option>
                <option value="Other" {% if patient.gender == 'Other' %}selected{% endif %}>Other</option>
            </select>
        </div>

        <div class="form-group">
            <label for="age">Age:</label>
            <input type="number" name="age" id="age" value="{{ patient.age }}" required class="form-control">
        </div>

        <div class="form-group">
            <label for="hypertension">Hypertension:</label>
            <select name="hypertension" id="hypertension" required class="form-control">
                <option value="0" {% if patient.hypertension == 0 %}selected{% endif %}>No</option>
                <option value="1" {% if patient.hypertension == 1 %}selected{% endif %}>Yes</option>
            </select>
        </div>

        <div class="form-group">
            <label for="ever_married">Ever Married:</label>
            <select name="ever_married" id="ever_married" required class="form-control">
                <option value="No" {% if patient.ever_married == 'No' %}selected{% endif %}>No</option>
                <option value="Yes" {% if patient.ever_married == 'Yes' %}selected{% endif %}>Yes</option>
            </select>
        </div>

        <div class="form-group">
            <label for="work_type">Work Type:</label>
            <select name="work_type" id="work_type" required class="form-control">
                <option value="Children" {% if patient.work_type == 'Children' %}selected{% endif %}>Children</option>
                <option value="Govt_job" {% if patient.work_type == 'Govt_job' %}selected{% endif %}>Government Job</option>
                <option value="Never_worked" {% if patient.work_type == 'Never_worked' %}selected{% endif %}>Never Worked</option>
                <option value="Private" {% if patient.work_type == 'Private' %}selected{% endif %}>Private</option>
                <option value="Self-employed" {% if patient.work_type == 'Self-employed' %}selected{% endif %}>Self Employed</option>
            </select>
        </div>

        <div class="form-group">
            <label for="residence_type">Residence Type:</label>
            <select name="residence_type" id="residence_type" required class="form-control">
                <option value="Rural" {% if patient.residence_type == 'Rural' %}selected{% endif %}>Rural</option>
                <option value="Urban" {% if patient.residence_type == 'Urban' %}selected{% endif %}>Urban</option>
            </select>
        </div>

        <div class="form-group">
            <label for="avg_glucose_level">Average Glucose Level:</label>
            <input type="number" name="avg_glucose_level" id="avg_glucose_level" value="{{ patient.avg_glucose_level }}" step="0.01" required class="form-control">
        </div>

        <div class="form-group">
            <label for="bmi">BMI:</label>
            <input type="number" name="bmi" id="bmi" value="{{ patient.bmi }}" step="0.01" required class="form-control">
        </div>

        <div class="form-group">
            <label for="smoking_status">Smoking Status:</label>
            <select name="smoking_status" id="smoking_status" required class="form-control">
                <option value="formerly smoked" {% if patient.smoking_status == 'formerly smoked' %}selected{% endif %}>Formerly Smoked</option>
                <option value="never smoked" {% if patient.smoking_status == 'never smoked' %}selected{% endif %}>Never Smoked</option>
                <option value="smokes" {% if patient.smoking_status == 'smokes' %}selected{% endif %}>Currently Smokes</option>
                <option value="Unknown" {% if patient.smoking_status == 'Unknown' %}selected{% endif %}>Unknown</option>
            </select>
        </div>

        <div class="form-group">
            <label for="stroke">Stroke:</label>
            <select name="stroke" id="stroke" required class="form-control">
                <option value="0" {% if patient.stroke == 0 %}selected{% endif %}>No</option>
                <option value="1" {% if patient.stroke == 1 %}selected{% endif %}>Yes</option>
            </select>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Save Changes</button>
            <a href="{{ url_for('view_patients', patient_id=patient.patient_id) }}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>
{% endblock %}